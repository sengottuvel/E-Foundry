<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
	
	<!-- Form View Start -->

		<record id="t_form_v_weekly_plan" model="ir.ui.view">
			<field name="name">Weekly Plan Form</field>
			<field name="model">kg.weekly.plan</field>
			<field name="arch" type="xml">
				<form string="Weekly Plan" version="7.0">
					<header>
						<button name="entry_approve" type="object" string="Approve" states="confirmed" class="oe_highlight" confirm="Are you sure to proceed ?"/>
						<button name="entry_confirm" type="object" string="Confirm" states="draft" class="oe_highlight"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,confirmed,approved,in_progress,completed"  readonly="1"/>
					</header>
					<sheet>
					<group>
						<group>
							<field name="name"/>						
							<field name="from_date" options="{'datepicker':{'maxDate': 50,'minDate':-10}}" attrs="{'readonly': [('state','in',['approved','in_progress','completed'])]}"/>						
							<field name="act1" invisible='1'/>
							<field name="act2" invisible='1'/>
							<field name="act3" invisible='1'/>
							<field name="count" invisible='1'/>
							<field name="count1" invisible='1'/>
						</group>
						<group>
							<field name="entry_date"  readonly='1'/>
							<field name="to_date" options="{'datepicker':{'maxDate': 50,'minDate':-10}}" attrs="{'readonly': [('state','in',['approved','in_progress','completed'])]}"/>
							<field name="act4" invisible='1'/>
							<field name="act5" invisible='1'/>
							<field name="act6" invisible='1'/>
							<field name="flag" invisible='1'/>
						</group>					
					</group>
					<button name="load_sch" type="object" attrs="{'invisible': [('state','not in',['draft'])]}" string="Load Schedule" class="oe_highlight"/>
					<notebook>
						<page string="Weekly Planning Details">
							<field name="line_ids" colspan="4" nolabel="1"  attrs="{'readonly': [('state','in',['approved','in_progress','completed'])]}"/>
						</page>
						<page string="Internal Notes">
							<field name="remark" nolabel='1' placeholder="Put an internal note..."/>
						</page>							
                        <page string="Entry Info">
							<group>
								<field name="company_id"/>
							</group>
							<group>
								<field name="active"/>
							</group>						
							<group>
								<group>
									<field name="user_id"/>
									<field name="confirm_user_id" attrs="{'invisible': [('state','=', 'draft')]}"/>
									<field name="ap_rej_user_id" attrs="{'invisible': [('state','in', ('draft','confirmed'))]}"/>
									<field name="update_user_id"/>
								</group>
								<group>
									<field name="crt_date"/>
									<field name="confirm_date" attrs="{'invisible': [('state','=', 'draft')]}"/>
									<field name="ap_rej_date" attrs="{'invisible': [('state','in', ('draft','confirmed'))]}"/>
									<field name="update_date"/>	
								</group>
							</group>
                        </page>            
						</notebook>				
					</sheet>
				</form>
			</field> 
		</record>
		
	<!-- Form View End -->
	     	
	
		
	<!-- Tree View Start -->
	
	
		<record id="t_tree_v_weekly_plan" model="ir.ui.view">
			<field name="name">Weekly Plan Tree</field>
			<field name="model">kg.weekly.plan</field>
			<field eval="8" name="priority"/>
			<field name="arch" type="xml">
				<tree toolbar="True" string="Weekly Plan" colors="blue:state == 'draft';red:state == 'confirmed';black:state == 'approved';green:state == 'in_progress';purple:state == 'completed'">					
					<field name="name"/>
					<field name="entry_date"/>
					<field name="from_date"/>
					<field name="to_date"/>
					<field name="state"/>
					<button name="daily_plan_create" string="Create DP" states="approved,in_progress" type="object" class="oe_highlight"/>					
				</tree>
			</field>
		</record>
	
		<record id="t_tree_v_cmp_weekly_plan" model="ir.ui.view">
			<field name="name">Completed Weekly Plan</field>
			<field name="model">kg.weekly.plan</field>
			<field eval="8" name="priority"/>
			<field name="arch" type="xml">
				<tree toolbar="True"  create="false" delete="false" string="Completed Weekly Plan" colors="blue:state == 'draft';red:state == 'confirmed';black:state == 'approved';green:state == 'in_progress';purple:state == 'completed'">					
					<field name="name"/>
					<field name="entry_date"/>
					<field name="from_date"/>
					<field name="to_date"/>
					<field name="state"/>
				</tree>
			</field>
		</record>
		
		
	<!-- Tree View End -->
	
	
	<!-- Child Class Tree View Start -->

        
        <record id="t_tree_v_weekly_plan_line" model="ir.ui.view">
            <field name="name">Weekly Plan Line Tree</field>
            <field name="model">ch.weekly.plan.line</field>
            <field name="type">tree</field>
			<field eval="8" name="priority"/>
            <field name="arch" type="xml">
				<tree string="Weekly Plan Line" editable="bottom">
					<field name="product_id" readonly='1'/>
					<field name="uom_id" readonly='1'/>
					<field name="sch_id" invisible='1'/>
					<field name="sch_line_id" invisible='1'/>
					<field name="weekly_qty" readonly='1'/>
					<field name="pending_qty" readonly='1'/>
					<field name="grade_id" readonly='1'/>
					<field name="tot_box" readonly='1'/>
					<field name="day1" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="day2" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="day3" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="day4" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="day5" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="day6" on_change="onchange_qty(day1,day2,day3,day4,day5,day6,total,pending_qty)"/>
					<field name="remain_dpl_qty" invisible='1'/>
					<field name="total" readonly='1'/>
                </tree> 
            </field>
        </record>
        
   	<!-- Child Class Tree View End -->
	

	<!-- Search View Start -->

		<record id="t_search_v_weekly_plan" model="ir.ui.view">
            <field name="name">Weekly Plan Search</field>
            <field name="model">kg.weekly.plan</field>
            <field name="arch" type="xml">
                <search string="Weekly Plan Search">
					<field name="name" string="Name"  filter_domain="[('name','ilike',self)]" />
					<separator/>
                    <group expand="0" string="Group By...">
                        <filter string="Status" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'state'}"/>
					</group>
                </search>
			</field>
		</record>
		
	<!-- Search View End -->

        
	<!-- Menu Action Start-->
		
		
		 <record id="tma_weekly_plan" model="ir.actions.act_window">
			<field name="name">Weekly Plan</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">kg.weekly.plan</field>
			<field name="view_type">form</field>
			<field name="context">{}</field>
			<field name="domain">[('state','!=','completed')]</field>
			<field name="view_id" ref="t_tree_v_weekly_plan"/>
			<field name="search_view_id" ref="t_search_v_weekly_plan"/>
			<field name="context">{"search_default_draft":1}</field>
		</record>
		
		
		 <record id="tma_cmp_weekly_plan" model="ir.actions.act_window">
			<field name="name">Completed Weekly Plan</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">kg.weekly.plan</field>
			<field name="view_mode">form,tree</field>
			<field name="context">{}</field>
			<field name="domain">[('state','=','completed')]</field>
			<field name="view_id" ref="t_tree_v_cmp_weekly_plan"/>
			<field name="search_view_id" ref="t_search_v_weekly_plan"/>
			<field name="context">{"search_default_draft":1}</field>
		</record>
		
	<!-- Menu Action End-->

	
	<!-- Audit Log Xml Data Start -->
		
        <record id="audit_weekly_plan" model="audittrail.rule">
            <field name="name">Audit Log Weekly Plan</field>
            <field name="object_id" eval="ref('kg_weekly_plan.model_kg_weekly_plan')"/>       
            <field name="state">subscribed</field>              
        </record>
		
        <record id="audit_weekly_plan_line" model="audittrail.rule">
            <field name="name">Audit Log Weekly Plan Line</field>
            <field name="object_id" eval="ref('kg_weekly_plan.model_ch_weekly_plan_line')"/>       
            <field name="state">subscribed</field>              
        </record>
        
    
        
    <!-- Audit Log Xml Data End-->	
		

		
	<!-- Menu Item Start -->
			
			<!-- Weekly Plan Menu -->
            <menuitem name="Planning" id="tpm_weekly_plan" parent = "base.menu_base_partner" sequence="4"/>
            
				
				<!-- Weekly Plan Action details-->
				
				<menuitem action="tma_weekly_plan" name="Weekly Planning" id="tam_weekly_plan" parent="tpm_weekly_plan" sequence="1"/>
				
				<menuitem action="tma_cmp_weekly_plan" name="Completed WP" id="tam_cmp_weekly_plan" parent="tpm_weekly_plan" sequence="1"/>
			
	
	<!-- Menu Item End -->		
		
</data>
	</openerp>
