<?xml version="1.0" encoding="utf-8"?>
<openerp>
	<data>
	
	<!-- Form View Start -->

		<record id="t_form_v_schedule" model="ir.ui.view">
			<field name="name">Schedule Entry Form</field>
			<field name="model">kg.schedule</field>
			<field name="arch" type="xml">
				<form string="Schedule" version="7.0">
					<header>
						<button name="entry_approve" type="object" string="Approve" states="confirmed" class="oe_highlight" confirm="Are you sure to proceed ?"/>
						<button name="entry_confirm" type="object" string="Confirm" states="draft" class="oe_highlight"/>
						<button name="load_so" type="object" attrs="{'invisible': [('state','not in',['draft'])]}" string="Load SO" class="oe_highlight"/>
						<field name="state" widget="statusbar" statusbar_visible="draft,confirmed,approved"  readonly="1"/>
					</header>
					<sheet>
					<group>
						<group>
							<field name="name"/>						
							<field name="customer_id" on_change="onchange_customer_id(customer_id,customer_address,customer_code)" attrs="{'readonly': [('customer_id','!=',False)]}"/>
							<field name="so_nos" string="SO No"  required='1' attrs="{'readonly': [('state','in',['approved'])]}" widget="many2many_tags" />
							<field name="customer_po" readonly='1'/>
							<field name="customer_po_sch" class="aplhanum_expect" attrs="{'readonly': [('state','in',['approved'])]}"/>
							<field name="so_date" invisible='1'/>
						</group>
						<group>
							<field name="entry_date" options="{'datepicker':{'maxDate': 0,'minDate':-10}}"/>
							<field name="customer_address" />
							<field name="customer_code" />
							<field name="customer_po_sch_date" options="{'datepicker':{'maxDate': null,'minDate':0}}" attrs="{'readonly': [('state','in',['approved'])]}"/>
						</group>					
					</group>
					<notebook>
						<page string="Schedule Details">
							<field name="line_ids" colspan="4" nolabel="1"  attrs="{'readonly': [('state','in',['approved'])]}">
								<tree string="Schedule Line">
									<field name="product_id"/>
									<field name="uom_id"/>              
									<field name="grade_id"/>              
									<field name="production_id"/>              
									<field name="schedule_qty" on_change="onchange_schedule_qty(schedule_qty,pending_qty)"/>
									<field name="pending_qty" readonly="1"/>
									<field name="schedule_date"/>
									<field name="line_state"/>
								</tree> 
								</field>
						</page>
						<page string="Internal Notes">
							<field name="remark" nolabel='1' placeholder="Put an internal note..."/>
						</page>							
                        <page string="Entry Info">
							<group>
								<field name="company_id"/>
							</group>
							<group>
								<field name="active"/>
							</group>						
							<group>
								<group>
									<field name="user_id"/>
									<field name="confirm_user_id" attrs="{'invisible': [('state','=', 'draft')]}"/>
									<field name="ap_rej_user_id" attrs="{'invisible': [('state','in', ('draft','confirmed'))]}"/>
									<field name="update_user_id"/>
								</group>
								<group>
									<field name="crt_date"/>
									<field name="confirm_date" attrs="{'invisible': [('state','=', 'draft')]}"/>
									<field name="ap_rej_date" attrs="{'invisible': [('state','in', ('draft','confirmed'))]}"/>
									<field name="update_date"/>	
								</group>
							</group>
                        </page>            
                        <page string="Notification Info">								
							<group>
								<group>
									<field name="flag_sms"/>										
								</group>
								<group>
									<field name="flag_email"/>
									<field name="flag_spl_approve"/>
								</group>
							</group>
							</page>            
						</notebook>				
					</sheet>
				</form>
			</field> 
		</record>
		
	<!-- Form View End -->
	
	
		
	<!--  Child Class Form View Start -->


        <record id="t_form_v_schedule_line" model="ir.ui.view">
            <field name="name">Schedule Line Entry Form</field>
            <field name="model">ch.schedule.line</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
				<form string="Schedule Line" version="7.0">
				  <group>
					<group>
						<field name="product_id" on_change="onchange_product_id(product_id,uom_id)"/>
						<field name="production_id"/>
						<field name="schedule_qty" on_change="onchange_schedule_qty(schedule_qty,pending_qty)"/>
						<field name="pending_qty" invisible='1'/>
						<field name="customer_id" invisible='1'/>
						<field name="remark"/>
                    </group> 
                    <group> 
						<field name="so_nos" invisible='1' widget="many2many_tags"/>
						<field name="grade_id"/>
						<field name="uom_id"/>
						<field name="order_qty"/>
						<field name="schedule_date"/>
					</group>
                  </group>
                </form> 
            </field>
        </record>
        
	<!--  Child Class Form View End -->        	
	
		
	<!-- Tree View Start -->
	
	
		<record id="t_tree_v_schedule" model="ir.ui.view">
			<field name="name">Schedule Entry Tree</field>
			<field name="model">kg.schedule</field>
			<field eval="8" name="priority"/>
			<field name="arch" type="xml">
				<tree toolbar="True" string="Schedule" colors="blue:state == 'draft';red:state == 'confirmed';black:state == 'approved'">					
					<field name="name"/>
					<field name="entry_date"/>
					<field name="customer_id"/>
					<field name="customer_po"/>
					<field name="so_nos"/>
					<field name="state"/>
				</tree>
			</field>
		</record>
		
		
	<!-- Tree View End -->
	
	
	<!-- Child Class Tree View Start -->

        
        <record id="t_tree_v_schedule_line_1" model="ir.ui.view">
            <field name="name">Schedule Line Tree</field>
            <field name="model">ch.schedule.line</field>
            <field name="type">tree</field>
			<field eval="8" name="priority"/>
            <field name="arch" type="xml">
				<tree string="Schedule Line" create="false" delete="false">
					<field name="product_id"/>
					<field name="uom_id"/>              
					<field name="header_id"/>              
					<field name="grade_id"/>              
					<field name="production_id"/>              
					<field name="schedule_qty" on_change="onchange_schedule_qty(schedule_qty,pending_qty)"/>
					<field name="pending_qty" readonly="1"/>
					<field name="schedule_date"/>
					<field name="line_state"/>
                </tree> 
            </field>
        </record>
        
   	<!-- Child Class Tree View End -->
	
	
	<!-- Schedule Detail Tree View Start -->

        
        <record id="t_tree_v_schedule_detail_1" model="ir.ui.view">
            <field name="name">Schedule Detail Tree</field>
            <field name="model">ch.schedule.line</field>
            <field name="type">tree</field>
			<field eval="8" name="priority"/>
            <field name="arch" type="xml">
				<tree string="Schedule Line" create="false" delete="false">
					<field name="customer_id" string="Customer Name"/>
					<field name="so_nos" string="SO.No"/>
					<field name="header_id" string="Schedule No"/>
					<field name="schedule_date" string="Delivery Date"/>
					<field name="product_id" string="Item"/>
					<field name="schedule_qty" string="Qty"/>
					<field name="pending_qty"/>
                </tree> 
            </field>
        </record>
        
   	<!-- Schedule Detail Tree View End -->


	<!-- Search View Start -->

		<record id="t_search_v_schedule" model="ir.ui.view">
            <field name="name">Schedule Entry Search</field>
            <field name="model">kg.schedule</field>
            <field name="arch" type="xml">
                <search string="Schedule Search">
					<field name="name" string="Name"  filter_domain="[('name','ilike',self)]" />
					<field name="customer_po" string="Customer PO"  filter_domain="[('customer_po','ilike',self)]" />
					<field name="customer_id" string="Customer Name"  filter_domain="[('customer_id','ilike',self)]" />
					<filter icon="terp-check" name="draft" string="Draft" domain="[('state','=','draft')]"/>
					<filter icon="terp-check" name="confirmed" string="Confirmed" domain="[('state','=','confirmed')]"/>					
					<separator/>
                    <group expand="0" string="Group By...">
						<filter string="Customer" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'customer_id'}"/>
                        <filter string="Status" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'state'}"/>
					</group>
                </search>
			</field>
		</record>
		
	<!-- Search View End -->
	
	
	
	<!-- Child Search View Start -->

		<record id="t_search_v_schedule_detail_1" model="ir.ui.view">
            <field name="name">Schedule Detail Search</field>
            <field name="model">ch.schedule.line</field>
            <field name="arch" type="xml">
                <search string="Schedule Detail Search">
					<field name="product_id" string="Product"  filter_domain="[('product_id','ilike',self)]" />
					<field name="header_id" string="Schedule No"  filter_domain="[('header_id','ilike',self)]" />
					<separator/>
                    <group expand="0" string="Group By...">
						<filter string="Product Id" name="group_product_id" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'product_id'}"/>
                        <filter string="Status" icon="terp-gtk-select-all" domain="[]" context="{'group_by':'state'}"/>
					</group>
                </search>
			</field>
		</record>
		
	<!-- Child Search View End -->		


        
	<!-- Menu Action Start-->
		
		
		 <record id="tma_schedule" model="ir.actions.act_window">
			<field name="name">Schedule</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">kg.schedule</field>
			<field name="view_type">form</field>
			<field name="context">{}</field>
			<field name="view_id" ref="t_tree_v_schedule"/>
			<field name="search_view_id" ref="t_search_v_schedule"/>
			<field name="context">{"search_default_draft":1}</field>
		</record>
		
	<!-- Menu Action End-->

	<!-- Child Menu Action Start-->		
		
		<record id="tma_schedule_line_1" model="ir.actions.act_window">
			<field name="name">Production</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">ch.schedule.line</field>
			<field name="view_mode">tree</field>
			<field name="view_id" ref="t_tree_v_schedule_line_1"/>
			<field name="domain">[('pending_qty','!=',0)]</field>
			<field name="search_view_id" ref="t_search_v_schedule_detail_1"/>
			<field name="context">{'search_default_group_product_id':1}</field>
		</record>			
		
	<!-- Child Menu Action End-->	
	
		
	<!-- Schedule Detail Action Start-->		

		<record id="tma_schedule_detail_1" model="ir.actions.act_window">
			<field name="name">Schedule Detail</field>
			<field name="type">ir.actions.act_window</field>
			<field name="res_model">ch.schedule.line</field>
			<field name="view_mode">tree</field>
			<field name="view_id" ref="t_tree_v_schedule_detail_1"/>
			<field name="domain">[('pending_qty','!=',0),('header_id.state','=','approved')]</field>
			<field name="search_view_id" ref="t_search_v_schedule_detail_1"/>
			<field name="context">{'search_default_group_product_id':1}</field>
		</record>	
		
	<!-- Schedule Detail Action End-->		
	
	
	<!-- Audit Log Xml Data Start -->
		
        <record id="audit_schedule" model="audittrail.rule">
            <field name="name">Audit Log Schedule</field>
            <field name="object_id" eval="ref('kg_schedule.model_kg_schedule')"/>       
            <field name="state">subscribed</field>              
        </record>
		
        <record id="audit_schedule_line" model="audittrail.rule">
            <field name="name">Audit Log Schedule Line</field>
            <field name="object_id" eval="ref('kg_schedule.model_ch_schedule_line')"/>       
            <field name="state">subscribed</field>              
        </record>
        
    
        
    <!-- Audit Log Xml Data End-->	
		

		
	<!-- Menu Item Start -->
			
			<!-- Schedule Menu -->
            <menuitem name="Schedule" id="tpm_schedule" parent = "base.menu_base_partner" sequence="2"/>
            
				<!-- Schedule -->
				<menuitem action="tma_schedule" name="Schedule" id="tam_schedule" parent="tpm_schedule" sequence="1"/>
				
				<!-- Schedule details-->
<!--
				<menuitem action="tma_schedule_detail_1" name="Schedule Details" id="tam_schedule_detail" parent="tpm_schedule_id" sequence="2"/>
-->
				
			<!-- Schedule Line Menu -->
            <menuitem name="Production" id="tpm_schedule_line" parent = "base.menu_base_partner" sequence="3"/>
            
				<!-- Schedule Line -->
				<menuitem action="tma_schedule_line_1"  name="Schedule Details" id="tam_schedule_line" parent="tpm_schedule_line" sequence="1"/>
				
	
	<!-- Menu Item End -->		
		
</data>
	</openerp>
